#+TITLE: The Demo CAS Server application
#+AUTHOR: Shubh
#+DATE: [2017-06-05 Mon]
#+SETUPFILE: ../../../../../org-templates/level-5.org
#+TAGS: boilerplate(b)
#+EXCLUDE_TAGS: boilerplate
#+OPTIONS: ^:nil


* Introduction

  Resources contains the configurations of your server, it is the most important directory for CAS applications
  
* Application Proeperties
  The Configurations are stored here: 
  Currently the following things have been set up,
   1.port:8443, 
   2.ssl-functionality, 
   3.initial-users list with their password,
   4.SAML protocols and use of facebook and twitter

#+BEGIN_SRC :eval no :tangle application.properties
# CAS Server Context Configuration
#
server.name=https://localhost:8443
server.context-path=/cas
server.port=8443
cas.server.http.enabled=false
cas.tgc.secure=false

cas.ticket.st.timeToKillInSeconds=600

#server.ssl.key-store=file:/etc/cas/thekeystore
#server.ssl.key-store-password=changeit
#server.ssl.key-password=changeit
server.max-http-header-size=2097152
server.max-http-post-size=2097152
#server.use-forward-headers=true


cas.service.security=https://localhost:8443/cas/login



# SSL
server.ssl.enabled=true

# Set the place of thekeystore
server.ssl.key-store=file:/home/shubh/vlead/cas/vlead-cas-overlay/public_private_keys/thekeystore
server.ssl.key-store-password=changeit
server.ssl.key-password=changeit

# server.ssl.ciphers=
# server.ssl.client-auth=
# server.ssl.enabled=
# server.ssl.key-alias=
# server.ssl.key-store-provider=
# server.ssl.key-store-type=
# server.ssl.protocol=
# server.ssl.trust-store=
# server.ssl.trust-store-password=
# server.ssl.trust-store-provider=
# server.ssl.trust-store-type=
        
server.tomcat.basedir=build/tomcat
server.tomcat.accesslog.enabled=true
server.tomcat.accesslog.pattern=%t %a "%r" %s (%D ms)
server.tomcat.accesslog.suffix=.log
server.tomcat.max-threads=5
server.tomcat.port-header=X-Forwarded-Port
server.tomcat.protocol-header=X-Forwarded-Proto
# server.tomcat.protocol-header-https-value=https
server.tomcat.remote-ip-header=X-FORWARDED-FOR
server.tomcat.uri-encoding=UTF-8
        
spring.http.encoding.charset=UTF-8
spring.http.encoding.enabled=true
spring.http.encoding.force=true

##
# CAS Cloud Bus Configuration
#
spring.cloud.bus.enabled=false
# spring.cloud.bus.refresh.enabled=true
# spring.cloud.bus.env.enabled=true
# spring.cloud.bus.destination=CasCloudBus
# spring.cloud.bus.ack.enabled=true

endpoints.enabled=true
endpoints.sensitive=true
management.context-path=/status
endpoints.restart.enabled=false
endpoints.shutdown.enabled=false


##
# CAS Web Application Session Configuration
#
server.session.timeout=300
server.session.cookie.http-only=true
server.session.tracking-modes=COOKIE

##
# CAS Thymeleaf View Configuration
#
spring.thymeleaf.encoding=UTF-8
spring.thymeleaf.cache=false

##
# CAS Log4j Configuration
#
# logging.config=file:/etc/cas/log4j2.xml
server.context-parameters.isLog4jAutoInitializationDisabled=true

##
# CAS AspectJ Configuration
#
spring.aop.auto=true
spring.aop.proxy-target-class=true

##
# CAS Authentication Credentials
#
cas.authn.accept.users=jleleu::jleleu,leleuj::leleuj,vlead::vlead

##
# CAS Authentication Attributes
#
cas.authn.attributeRepository.attributes.uid=uid
cas.authn.attributeRepository.attributes.displayName=displayName
cas.authn.attributeRepository.attributes.cn=commonName
cas.authn.attributeRepository.attributes.affiliation=groupMembership


#+END_SRC

* BootStrap Properties
  As in an operating system, bootstrap file is used to initialize and start the server
#+BEGIN_SRC :eval no :tangle bootstrap.properties
##
# CAS Spring Cloud Config Client
#
# Name of the application for which environment settings and properties should be fetched.
# This should map to a cas.yml or cas.properties file.
spring.application.name=cas
spring.cloud.config.fail-fast=true
        
## 
# CAS Embedded Cloud Config Server
#
# Native profile in the Config Server that doesn't use Git, but just loads the 
# config files from the local classpath or file system.
#
spring.profiles.active=native
spring.cloud.config.server.native.searchLocations=file:///etc/cas/config
        
# spring.profiles.active=default
# spring.cloud.config.server.git.uri=https://github.com/repoName/config
# spring.cloud.config.server.git.uri=file://${user.home}/config
# spring.cloud.config.server.git.username=
# spring.cloud.config.server.git.password=
spring.cloud.config.server.bootstrap=true
spring.cloud.config.server.prefix=/configserver
spring.jmx.default-domain=server

#+END_SRC

* CAS theme
  To link the javascript and the stylesheets we have a default theme
#+BEGIN_SRC :eval no :tangle cas-theme-default.properties
standard.custom.css.file=/css/cas.css
cas.javascript.file=/js/cas.js
#+END_SRC
  
* Deployer Configuration 
  Beans for CAS
#+BEGIN_SRC :eval :no :tangle deployerConfigContext.groovy
beans {
    xmlns([context:'http://www.springframework.org/schema/context'])
    xmlns([lang:'http://www.springframework.org/schema/lang'])
    xmlns([util:'http://www.springframework.org/schema/util'])
    xmlns([metrics:'http://www.ryantenney.com/schema/metrics'])

    metrics.'annotation-driven'('metric-registry':'metrics','health-check-registry':'healthCheckMetrics')
}


#+END_SRC  

* Logging errors and files
  This documents the file which stores the configuration of logging the server
#+BEGIN_SRC :eval no :tangle log4j2.xml
<?xml version="1.0" encoding="UTF-8" ?>
<Configuration monitorInterval="10">
    <Appenders>
        <Console name="console" target="SYSTEM_OUT">
            <PatternLayout pattern="%d %p [%c] - &lt;%m&gt;%n"/>
        </Console>

        <RollingFile name="file" fileName="cas.log" append="true"
                     filePattern="cas-%d{yyyy-MM-dd-HH}-%i.log">
            <PatternLayout pattern="%d %p [%c] - &lt;%m&gt;%n"/>
            <Policies>
                <OnStartupTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="10 MB"/>
                <TimeBasedTriggeringPolicy />
            </Policies>
        </RollingFile>
        <RollingFile name="auditlogfile" fileName="cas_audit.log" append="true"
                     filePattern="cas_audit-%d{yyyy-MM-dd-HH}-%i.log">
            <PatternLayout pattern="%d %p [%c] - %m%n"/>
            <Policies>
                <OnStartupTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="10 MB"/>
                <TimeBasedTriggeringPolicy />
            </Policies>
        </RollingFile>

        <RollingFile name="perfFileAppender" fileName="perfStats.log" append="true"
                     filePattern="perfStats-%d{yyyy-MM-dd-HH}-%i.log">
            <PatternLayout pattern="%m%n"/>
            <Policies>
                <OnStartupTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="10 MB"/>
                <TimeBasedTriggeringPolicy />
            </Policies>
        </RollingFile>

        <CasAppender name="casAudit">
            <AppenderRef ref="auditlogfile" />
        </CasAppender>
        <CasAppender name="casFile">
            <AppenderRef ref="file" />
        </CasAppender>
        <CasAppender name="casConsole">
            <AppenderRef ref="console" />
        </CasAppender>
        <CasAppender name="casPerf">
            <AppenderRef ref="perfFileAppender" />
        </CasAppender>
    </Appenders>
    <Loggers>
        <AsyncLogger name="org.apereo" level="info" additivity="false" includeLocation="true">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.apache.catalina" level="debug" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework.cloud.server" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework.cloud.client" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework.cloud.bus" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework.aop" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework.boot" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework.boot.actuate.autoconfigure" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework.webflow" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework.session" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework.amqp" level="off" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework.integration" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework.messaging" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework.web" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework.orm.jpa" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework.scheduling" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.thymeleaf" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.pac4j" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.opensaml" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="net.sf.ehcache" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="com.ryantenney.metrics" level="warn" additivity="false">
            <AppenderRef ref="console"/>
            <AppenderRef ref="file"/>
        </AsyncLogger>
        <AsyncLogger name="net.jradius" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.openid4java" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.ldaptive" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="com.hazelcast" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework.context.annotation" level="off" additivity="false" />
        <AsyncLogger name="org.jasig.spring" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.springframework.web.socket" level="warn" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>

        <AsyncLogger name="org.apache.http" level="off" additivity="false">
            <AppenderRef ref="casConsole"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="perfStatsLogger" level="info" additivity="false" includeLocation="true">
            <AppenderRef ref="casPerf"/>
        </AsyncLogger>
        <AsyncLogger name="org.apereo.cas.web.flow" level="info" additivity="true" includeLocation="true">
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncLogger name="org.apereo.inspektr.audit.support" level="info" includeLocation="true">
            <AppenderRef ref="casAudit"/>
            <AppenderRef ref="casFile"/>
        </AsyncLogger>
        <AsyncRoot level="error">
            <AppenderRef ref="casConsole"/>
        </AsyncRoot>
    </Loggers>
</Configuration>


#+END_SRC

* User Properties
  The general user properties, the various types of user, eg: Admin are stored here
#+BEGIN_SRC :eval no :tangle user-details.properties
# This file lists the set of users that are allowed access to the CAS sensitive/admin endpoints.
#
# The syntax of each entry should be in the form of:
# 
# username=password,grantedAuthority[,grantedAuthority][,enabled|disabled]

# Example:
casuser=casuser,ROLE_ADMIN


#+END_SRC
* Services
  Various Clients of VLEAD are stored in the form of JSON. The domain
  under which a service is defined is stated using regex. Examples are shown below:

** Front Server Example 
   This takes all care of all the json files starting with =https://front=
#+BEGIN_SRC :eval no :tangle services/front-0.json
{
  "@class" : "org.apereo.cas.services.RegexRegisteredService",
  "serviceId" : "^https?://front.*",
  "name" : "front",
  "id" : 0,
  "description" : "Allows only front services",
  "logoutType" : "FRONT_CHANNEL"
}

#+END_SRC
** Back Server Example
   This is used for all the back services
   #+BEGIN_SRC :eval no :tangle services/back-1.json
{
  "@class" : "org.apereo.cas.services.RegexRegisteredService",
  "serviceId" : "^https?://back.*",
  "name" : "back",
  "id" : 1,
  "description" : "Allows only back services",
  "logoutType" : "BACK_CHANNEL",
  "attributeReleasePolicy" : {
    "@class" : "org.apereo.cas.services.ReturnAllowedAttributeReleasePolicy",
    "principalAttributesRepository" : {
      "@class" : "org.apereo.cas.authentication.principal.DefaultPrincipalAttributesRepository"
    },
    "authorizedToReleaseCredentialPassword" : false,
    "authorizedToReleaseProxyGrantingTicket" : false
  }
}

   
   #+END_SRC
   
** Localhost Server Example
   All localhost, services come under this service
#+BEGIN_SRC :eval no :tangle services/CasClient-2.json
{
  "@class" : "org.apereo.cas.services.RegexRegisteredService",
  "serviceId" : "^https?://localhost.*",
  "name" : "CasClient",
  "id" : 2,
  "description" : "Allows only localhost services"

}

#+END_SRC

** LDS Dashboard
   This is different from localhost Server because of =0.0.0.0= is
   considered a seprate domian from localhost
#+BEGIN_SRC :eval no :tangle LDS-3.json
{
  "@class" : "org.apereo.cas.services.RegexRegisteredService",
  "serviceId" : "^https?://0.0.0.0.*",
  "name" : "LDS-3",
  "id" : 3,
  "description" : "LDS DASHBOARD"
}
#+END_SRC 
* testshib-providers
  This file contains the metadata for the testing IdP and SP that are
  operated by TestShib as a service for testing new Shibboleth and
  SAML providers.
#+BEGIN_SRC :eval no :tangle testshib-providers.xml

<EntitiesDescriptor Name="urn:mace:shibboleth:testshib:two"
                    xmlns="urn:oasis:names:tc:SAML:2.0:metadata" xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
                    xmlns:mdalg="urn:oasis:names:tc:SAML:metadata:algsupport" xmlns:mdui="urn:oasis:names:tc:SAML:metadata:ui"
                    xmlns:shibmd="urn:mace:shibboleth:metadata:1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

    <EntityDescriptor entityID="https://idp.testshib.org/idp/shibboleth">

        <Extensions>
            <mdalg:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha512" />
            <mdalg:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#sha384" />
            <mdalg:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256" />
            <mdalg:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />
            <mdalg:SigningMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha512" />
            <mdalg:SigningMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha384" />
            <mdalg:SigningMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256" />
            <mdalg:SigningMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1" />
        </Extensions>

        <IDPSSODescriptor
                protocolSupportEnumeration="urn:oasis:names:tc:SAML:1.1:protocol urn:mace:shibboleth:1.0 urn:oasis:names:tc:SAML:2.0:protocol">
            <Extensions>
                <shibmd:Scope regexp="false">testshib.org</shibmd:Scope>
                <mdui:UIInfo>
                    <mdui:DisplayName xml:lang="en">TestShib Test IdP</mdui:DisplayName>
                    <mdui:Description xml:lang="en">TestShib IdP. Use this as a source of attributes
                        for your test SP.</mdui:Description>
                    <mdui:Logo height="88" width="253"
                    >https://www.testshib.org/testshibtwo.jpg</mdui:Logo>
                </mdui:UIInfo>

            </Extensions>
            <!-- old signing key
            <KeyDescriptor>
                <ds:KeyInfo>
                    <ds:X509Data>
                        <ds:X509Certificate>
                            MIIEDjCCAvagAwIBAgIBADANBgkqhkiG9w0BAQUFADBnMQswCQYDVQQGEwJVUzEV
                            MBMGA1UECBMMUGVubnN5bHZhbmlhMRMwEQYDVQQHEwpQaXR0c2J1cmdoMREwDwYD
                            VQQKEwhUZXN0U2hpYjEZMBcGA1UEAxMQaWRwLnRlc3RzaGliLm9yZzAeFw0wNjA4
                            MzAyMTEyMjVaFw0xNjA4MjcyMTEyMjVaMGcxCzAJBgNVBAYTAlVTMRUwEwYDVQQI
                            EwxQZW5uc3lsdmFuaWExEzARBgNVBAcTClBpdHRzYnVyZ2gxETAPBgNVBAoTCFRl
                            c3RTaGliMRkwFwYDVQQDExBpZHAudGVzdHNoaWIub3JnMIIBIjANBgkqhkiG9w0B
                            AQEFAAOCAQ8AMIIBCgKCAQEArYkCGuTmJp9eAOSGHwRJo1SNatB5ZOKqDM9ysg7C
                            yVTDClcpu93gSP10nH4gkCZOlnESNgttg0r+MqL8tfJC6ybddEFB3YBo8PZajKSe
                            3OQ01Ow3yT4I+Wdg1tsTpSge9gEz7SrC07EkYmHuPtd71CHiUaCWDv+xVfUQX0aT
                            NPFmDixzUjoYzbGDrtAyCqA8f9CN2txIfJnpHE6q6CmKcoLADS4UrNPlhHSzd614
                            kR/JYiks0K4kbRqCQF0Dv0P5Di+rEfefC6glV8ysC8dB5/9nb0yh/ojRuJGmgMWH
                            gWk6h0ihjihqiu4jACovUZ7vVOCgSE5Ipn7OIwqd93zp2wIDAQABo4HEMIHBMB0G
                            A1UdDgQWBBSsBQ869nh83KqZr5jArr4/7b+QazCBkQYDVR0jBIGJMIGGgBSsBQ86
                            9nh83KqZr5jArr4/7b+Qa6FrpGkwZzELMAkGA1UEBhMCVVMxFTATBgNVBAgTDFBl
                            bm5zeWx2YW5pYTETMBEGA1UEBxMKUGl0dHNidXJnaDERMA8GA1UEChMIVGVzdFNo
                            aWIxGTAXBgNVBAMTEGlkcC50ZXN0c2hpYi5vcmeCAQAwDAYDVR0TBAUwAwEB/zAN
                            BgkqhkiG9w0BAQUFAAOCAQEAjR29PhrCbk8qLN5MFfSVk98t3CT9jHZoYxd8QMRL
                            I4j7iYQxXiGJTT1FXs1nd4Rha9un+LqTfeMMYqISdDDI6tv8iNpkOAvZZUosVkUo
                            93pv1T0RPz35hcHHYq2yee59HJOco2bFlcsH8JBXRSRrJ3Q7Eut+z9uo80JdGNJ4
                            /SJy5UorZ8KazGj16lfJhOBXldgrhppQBb0Nq6HKHguqmwRfJ+WkxemZXzhediAj
                            Geka8nz8JjwxpUjAiSWYKLtJhGEaTqCYxCCX2Dw+dOTqUzHOZ7WKv4JXPK5G/Uhr
                            8K/qhmFT2nIQi538n6rVYLeWj8Bbnl+ev0peYzxFyF5sQA==
                        </ds:X509Certificate>
                    </ds:X509Data>
                </ds:KeyInfo>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes256-cbc"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes192-cbc" />
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes128-cbc"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5"/>
            </KeyDescriptor>
            -->

            <!-- new signing key -->
            <KeyDescriptor>
                <ds:KeyInfo>
                    <ds:X509Data>
                        <ds:X509Certificate>
                            MIIDAzCCAeugAwIBAgIVAPX0G6LuoXnKS0Muei006mVSBXbvMA0GCSqGSIb3DQEB
                            CwUAMBsxGTAXBgNVBAMMEGlkcC50ZXN0c2hpYi5vcmcwHhcNMTYwODIzMjEyMDU0
                            WhcNMzYwODIzMjEyMDU0WjAbMRkwFwYDVQQDDBBpZHAudGVzdHNoaWIub3JnMIIB
                            IjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAg9C4J2DiRTEhJAWzPt1S3ryh
                            m3M2P3hPpwJwvt2q948vdTUxhhvNMuc3M3S4WNh6JYBs53R+YmjqJAII4ShMGNEm
                            lGnSVfHorex7IxikpuDPKV3SNf28mCAZbQrX+hWA+ann/uifVzqXktOjs6DdzdBn
                            xoVhniXgC8WCJwKcx6JO/hHsH1rG/0DSDeZFpTTcZHj4S9MlLNUtt5JxRzV/MmmB
                            3ObaX0CMqsSWUOQeE4nylSlp5RWHCnx70cs9kwz5WrflnbnzCeHU2sdbNotBEeTH
                            ot6a2cj/pXlRJIgPsrL/4VSicPZcGYMJMPoLTJ8mdy6mpR6nbCmP7dVbCIm/DQID
                            AQABoz4wPDAdBgNVHQ4EFgQUUfaDa2mPi24x09yWp1OFXmZ2GPswGwYDVR0RBBQw
                            EoIQaWRwLnRlc3RzaGliLm9yZzANBgkqhkiG9w0BAQsFAAOCAQEASKKgqTxhqBzR
                            OZ1eVy++si+eTTUQZU4+8UywSKLia2RattaAPMAcXUjO+3cYOQXLVASdlJtt+8QP
                            dRkfp8SiJemHPXC8BES83pogJPYEGJsKo19l4XFJHPnPy+Dsn3mlJyOfAa8RyWBS
                            80u5lrvAcr2TJXt9fXgkYs7BOCigxtZoR8flceGRlAZ4p5FPPxQR6NDYb645jtOT
                            MVr3zgfjP6Wh2dt+2p04LG7ENJn8/gEwtXVuXCsPoSCDx9Y0QmyXTJNdV1aB0AhO
                            RkWPlFYwp+zOyOIR+3m1+pqWFpn0eT/HrxpdKa74FA3R2kq4R7dXe4G0kUgXTdqX
                            MLRKhDgdmA==
                        </ds:X509Certificate>
                    </ds:X509Data>
                </ds:KeyInfo>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes256-cbc"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes192-cbc" />
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes128-cbc"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5"/>
            </KeyDescriptor>

            <ArtifactResolutionService Binding="urn:oasis:names:tc:SAML:1.0:bindings:SOAP-binding"
                                       Location="https://idp.testshib.org:8443/idp/profile/SAML1/SOAP/ArtifactResolution"
                                       index="1"/>
            <ArtifactResolutionService Binding="urn:oasis:names:tc:SAML:2.0:bindings:SOAP"
                                       Location="https://idp.testshib.org:8443/idp/profile/SAML2/SOAP/ArtifactResolution"
                                       index="2"/>

            <NameIDFormat>urn:mace:shibboleth:1.0:nameIdentifier</NameIDFormat>
            <NameIDFormat>urn:oasis:names:tc:SAML:2.0:nameid-format:transient</NameIDFormat>

            <SingleSignOnService Binding="urn:mace:shibboleth:1.0:profiles:AuthnRequest"
                                 Location="https://idp.testshib.org/idp/profile/Shibboleth/SSO"/>
            <SingleSignOnService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST"
                                 Location="https://idp.testshib.org/idp/profile/SAML2/POST/SSO"/>
            <SingleSignOnService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect"
                                 Location="https://idp.testshib.org/idp/profile/SAML2/Redirect/SSO"/>
            <SingleSignOnService Binding="urn:oasis:names:tc:SAML:2.0:bindings:SOAP"
                                 Location="https://idp.testshib.org/idp/profile/SAML2/SOAP/ECP"/>

        </IDPSSODescriptor>

        <AttributeAuthorityDescriptor
                protocolSupportEnumeration="urn:oasis:names:tc:SAML:1.1:protocol urn:oasis:names:tc:SAML:2.0:protocol">

            <!-- old SSL/TLS
            <KeyDescriptor>
                <ds:KeyInfo>
                    <ds:X509Data>
                        <ds:X509Certificate>
                            MIIEDjCCAvagAwIBAgIBADANBgkqhkiG9w0BAQUFADBnMQswCQYDVQQGEwJVUzEV
                            MBMGA1UECBMMUGVubnN5bHZhbmlhMRMwEQYDVQQHEwpQaXR0c2J1cmdoMREwDwYD
                            VQQKEwhUZXN0U2hpYjEZMBcGA1UEAxMQaWRwLnRlc3RzaGliLm9yZzAeFw0wNjA4
                            MzAyMTEyMjVaFw0xNjA4MjcyMTEyMjVaMGcxCzAJBgNVBAYTAlVTMRUwEwYDVQQI
                            EwxQZW5uc3lsdmFuaWExEzARBgNVBAcTClBpdHRzYnVyZ2gxETAPBgNVBAoTCFRl
                            c3RTaGliMRkwFwYDVQQDExBpZHAudGVzdHNoaWIub3JnMIIBIjANBgkqhkiG9w0B
                            AQEFAAOCAQ8AMIIBCgKCAQEArYkCGuTmJp9eAOSGHwRJo1SNatB5ZOKqDM9ysg7C
                            yVTDClcpu93gSP10nH4gkCZOlnESNgttg0r+MqL8tfJC6ybddEFB3YBo8PZajKSe
                            3OQ01Ow3yT4I+Wdg1tsTpSge9gEz7SrC07EkYmHuPtd71CHiUaCWDv+xVfUQX0aT
                            NPFmDixzUjoYzbGDrtAyCqA8f9CN2txIfJnpHE6q6CmKcoLADS4UrNPlhHSzd614
                            kR/JYiks0K4kbRqCQF0Dv0P5Di+rEfefC6glV8ysC8dB5/9nb0yh/ojRuJGmgMWH
                            gWk6h0ihjihqiu4jACovUZ7vVOCgSE5Ipn7OIwqd93zp2wIDAQABo4HEMIHBMB0G
                            A1UdDgQWBBSsBQ869nh83KqZr5jArr4/7b+QazCBkQYDVR0jBIGJMIGGgBSsBQ86
                            9nh83KqZr5jArr4/7b+Qa6FrpGkwZzELMAkGA1UEBhMCVVMxFTATBgNVBAgTDFBl
                            bm5zeWx2YW5pYTETMBEGA1UEBxMKUGl0dHNidXJnaDERMA8GA1UEChMIVGVzdFNo
                            aWIxGTAXBgNVBAMTEGlkcC50ZXN0c2hpYi5vcmeCAQAwDAYDVR0TBAUwAwEB/zAN
                            BgkqhkiG9w0BAQUFAAOCAQEAjR29PhrCbk8qLN5MFfSVk98t3CT9jHZoYxd8QMRL
                            I4j7iYQxXiGJTT1FXs1nd4Rha9un+LqTfeMMYqISdDDI6tv8iNpkOAvZZUosVkUo
                            93pv1T0RPz35hcHHYq2yee59HJOco2bFlcsH8JBXRSRrJ3Q7Eut+z9uo80JdGNJ4
                            /SJy5UorZ8KazGj16lfJhOBXldgrhppQBb0Nq6HKHguqmwRfJ+WkxemZXzhediAj
                            Geka8nz8JjwxpUjAiSWYKLtJhGEaTqCYxCCX2Dw+dOTqUzHOZ7WKv4JXPK5G/Uhr
                            8K/qhmFT2nIQi538n6rVYLeWj8Bbnl+ev0peYzxFyF5sQA==
                        </ds:X509Certificate>
                    </ds:X509Data>
                </ds:KeyInfo>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes256-cbc"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes192-cbc" />
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes128-cbc"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5"/>
            </KeyDescriptor>
            -->

            <!-- new SSL/TLS -->
            <KeyDescriptor>
                <ds:KeyInfo>
                    <ds:X509Data>
                        <ds:X509Certificate>
                            MIIDAzCCAeugAwIBAgIVAPX0G6LuoXnKS0Muei006mVSBXbvMA0GCSqGSIb3DQEB
                            CwUAMBsxGTAXBgNVBAMMEGlkcC50ZXN0c2hpYi5vcmcwHhcNMTYwODIzMjEyMDU0
                            WhcNMzYwODIzMjEyMDU0WjAbMRkwFwYDVQQDDBBpZHAudGVzdHNoaWIub3JnMIIB
                            IjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAg9C4J2DiRTEhJAWzPt1S3ryh
                            m3M2P3hPpwJwvt2q948vdTUxhhvNMuc3M3S4WNh6JYBs53R+YmjqJAII4ShMGNEm
                            lGnSVfHorex7IxikpuDPKV3SNf28mCAZbQrX+hWA+ann/uifVzqXktOjs6DdzdBn
                            xoVhniXgC8WCJwKcx6JO/hHsH1rG/0DSDeZFpTTcZHj4S9MlLNUtt5JxRzV/MmmB
                            3ObaX0CMqsSWUOQeE4nylSlp5RWHCnx70cs9kwz5WrflnbnzCeHU2sdbNotBEeTH
                            ot6a2cj/pXlRJIgPsrL/4VSicPZcGYMJMPoLTJ8mdy6mpR6nbCmP7dVbCIm/DQID
                            AQABoz4wPDAdBgNVHQ4EFgQUUfaDa2mPi24x09yWp1OFXmZ2GPswGwYDVR0RBBQw
                            EoIQaWRwLnRlc3RzaGliLm9yZzANBgkqhkiG9w0BAQsFAAOCAQEASKKgqTxhqBzR
                            OZ1eVy++si+eTTUQZU4+8UywSKLia2RattaAPMAcXUjO+3cYOQXLVASdlJtt+8QP
                            dRkfp8SiJemHPXC8BES83pogJPYEGJsKo19l4XFJHPnPy+Dsn3mlJyOfAa8RyWBS
                            80u5lrvAcr2TJXt9fXgkYs7BOCigxtZoR8flceGRlAZ4p5FPPxQR6NDYb645jtOT
                            MVr3zgfjP6Wh2dt+2p04LG7ENJn8/gEwtXVuXCsPoSCDx9Y0QmyXTJNdV1aB0AhO
                            RkWPlFYwp+zOyOIR+3m1+pqWFpn0eT/HrxpdKa74FA3R2kq4R7dXe4G0kUgXTdqX
                            MLRKhDgdmA==
                        </ds:X509Certificate>
                    </ds:X509Data>
                </ds:KeyInfo>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes256-cbc"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes192-cbc" />
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes128-cbc"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5"/>
            </KeyDescriptor>

            <AttributeService Binding="urn:oasis:names:tc:SAML:1.0:bindings:SOAP-binding"
                              Location="https://idp.testshib.org:8443/idp/profile/SAML1/SOAP/AttributeQuery"/>
            <AttributeService Binding="urn:oasis:names:tc:SAML:2.0:bindings:SOAP"
                              Location="https://idp.testshib.org:8443/idp/profile/SAML2/SOAP/AttributeQuery"/>

            <NameIDFormat>urn:mace:shibboleth:1.0:nameIdentifier</NameIDFormat>
            <NameIDFormat>urn:oasis:names:tc:SAML:2.0:nameid-format:transient</NameIDFormat>

        </AttributeAuthorityDescriptor>

        <Organization>
            <OrganizationName xml:lang="en">TestShib Two Identity Provider</OrganizationName>
            <OrganizationDisplayName xml:lang="en">TestShib Two</OrganizationDisplayName>
            <OrganizationURL xml:lang="en">http://www.testshib.org/testshib-two/</OrganizationURL>
        </Organization>
        <ContactPerson contactType="technical">
            <GivenName>Nate</GivenName>
            <SurName>Klingenstein</SurName>
            <EmailAddress>ndk@internet2.edu</EmailAddress>
        </ContactPerson>
    </EntityDescriptor>

    <!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = -->
    <!--             Metadata for SP.TESTSHIB.ORG                    -->
    <!-- = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = -->

    <EntityDescriptor entityID="https://sp.testshib.org/shibboleth-sp">

        <Extensions>
            <mdalg:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha512"/>
            <mdalg:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#sha384"/>
            <mdalg:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
            <mdalg:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#sha224"/>
            <mdalg:DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
            <mdalg:SigningMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha512"/>
            <mdalg:SigningMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha384"/>
            <mdalg:SigningMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256"/>
            <mdalg:SigningMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha224"/>
            <mdalg:SigningMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha512"/>
            <mdalg:SigningMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha384"/>
            <mdalg:SigningMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>
            <mdalg:SigningMethod Algorithm="http://www.w3.org/2009/xmldsig11#dsa-sha256"/>
            <mdalg:SigningMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha1"/>
            <mdalg:SigningMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
            <mdalg:SigningMethod Algorithm="http://www.w3.org/2000/09/xmldsig#dsa-sha1"/>
        </Extensions>


        <!-- An SP supporting SAML 1 and 2 contains this element with protocol support as shown. -->
        <SPSSODescriptor
                protocolSupportEnumeration="urn:oasis:names:tc:SAML:2.0:protocol urn:oasis:names:tc:SAML:1.1:protocol http://schemas.xmlsoap.org/ws/2003/07/secext">

            <Extensions>
                <!-- A request initiator at /Testshib that you can use to customize authentication requests issued to your IdP by TestShib. -->
                <init:RequestInitiator xmlns:init="urn:oasis:names:tc:SAML:profiles:SSO:request-init" Binding="urn:oasis:names:tc:SAML:profiles:SSO:request-init" Location="https://sp.testshib.org/Shibboleth.sso/TestShib"/>

                <mdui:UIInfo>
                    <mdui:DisplayName xml:lang="en">TestShib Test SP</mdui:DisplayName>
                    <mdui:Description xml:lang="en">TestShib SP. Log into this to test your machine.
                        Once logged in check that all attributes that you expected have been
                        released.</mdui:Description>
                    <mdui:Logo height="88" width="253">https://www.testshib.org/testshibtwo.jpg</mdui:Logo>
                </mdui:UIInfo>
            </Extensions>

            <KeyDescriptor>
                <ds:KeyInfo>
                    <ds:X509Data>
                        <ds:X509Certificate>
                            MIIEPjCCAyagAwIBAgIBADANBgkqhkiG9w0BAQUFADB3MQswCQYDVQQGEwJVUzEV
                            MBMGA1UECBMMUGVubnN5bHZhbmlhMRMwEQYDVQQHEwpQaXR0c2J1cmdoMSIwIAYD
                            VQQKExlUZXN0U2hpYiBTZXJ2aWNlIFByb3ZpZGVyMRgwFgYDVQQDEw9zcC50ZXN0
                            c2hpYi5vcmcwHhcNMDYwODMwMjEyNDM5WhcNMTYwODI3MjEyNDM5WjB3MQswCQYD
                            VQQGEwJVUzEVMBMGA1UECBMMUGVubnN5bHZhbmlhMRMwEQYDVQQHEwpQaXR0c2J1
                            cmdoMSIwIAYDVQQKExlUZXN0U2hpYiBTZXJ2aWNlIFByb3ZpZGVyMRgwFgYDVQQD
                            Ew9zcC50ZXN0c2hpYi5vcmcwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIB
                            AQDJyR6ZP6MXkQ9z6RRziT0AuCabDd3x1m7nLO9ZRPbr0v1LsU+nnC363jO8nGEq
                            sqkgiZ/bSsO5lvjEt4ehff57ERio2Qk9cYw8XCgmYccVXKH9M+QVO1MQwErNobWb
                            AjiVkuhWcwLWQwTDBowfKXI87SA7KR7sFUymNx5z1aoRvk3GM++tiPY6u4shy8c7
                            vpWbVfisfTfvef/y+galxjPUQYHmegu7vCbjYP3On0V7/Ivzr+r2aPhp8egxt00Q
                            XpilNai12LBYV3Nv/lMsUzBeB7+CdXRVjZOHGuQ8mGqEbsj8MBXvcxIKbcpeK5Zi
                            JCVXPfarzuriM1G5y5QkKW+LAgMBAAGjgdQwgdEwHQYDVR0OBBYEFKB6wPDxwYrY
                            StNjU5P4b4AjBVQVMIGhBgNVHSMEgZkwgZaAFKB6wPDxwYrYStNjU5P4b4AjBVQV
                            oXukeTB3MQswCQYDVQQGEwJVUzEVMBMGA1UECBMMUGVubnN5bHZhbmlhMRMwEQYD
                            VQQHEwpQaXR0c2J1cmdoMSIwIAYDVQQKExlUZXN0U2hpYiBTZXJ2aWNlIFByb3Zp
                            ZGVyMRgwFgYDVQQDEw9zcC50ZXN0c2hpYi5vcmeCAQAwDAYDVR0TBAUwAwEB/zAN
                            BgkqhkiG9w0BAQUFAAOCAQEAc06Kgt7ZP6g2TIZgMbFxg6vKwvDL0+2dzF11Onpl
                            5sbtkPaNIcj24lQ4vajCrrGKdzHXo9m54BzrdRJ7xDYtw0dbu37l1IZVmiZr12eE
                            Iay/5YMU+aWP1z70h867ZQ7/7Y4HW345rdiS6EW663oH732wSYNt9kr7/0Uer3KD
                            9CuPuOidBacospDaFyfsaJruE99Kd6Eu/w5KLAGG+m0iqENCziDGzVA47TngKz2v
                            PVA+aokoOyoz3b53qeti77ijatSEoKjxheBWpO+eoJeGq/e49Um3M2ogIX/JAlMa
                            Inh+vYSYngQB2sx9LGkR9KHaMKNIGCDehk93Xla4pWJx1w==
                        </ds:X509Certificate>
                    </ds:X509Data>
                </ds:KeyInfo>
                <EncryptionMethod Algorithm="http://www.w3.org/2009/xmlenc11#aes128-gcm"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2009/xmlenc11#aes192-gcm"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2009/xmlenc11#aes256-gcm"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes128-cbc"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes192-cbc"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes256-cbc"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2009/xmlenc11#rsa-oaep"/>
                <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p"/>
            </KeyDescriptor>

            <!-- This tells IdPs that Single Logout is supported and where/how to request it. -->

            <SingleLogoutService Location="https://sp.testshib.org/Shibboleth.sso/SLO/SOAP"
                                 Binding="urn:oasis:names:tc:SAML:2.0:bindings:SOAP"/>
            <SingleLogoutService Location="https://sp.testshib.org/Shibboleth.sso/SLO/Redirect"
                                 Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect"/>
            <SingleLogoutService Location="https://sp.testshib.org/Shibboleth.sso/SLO/POST"
                                 Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST"/>
            <SingleLogoutService Location="https://sp.testshib.org/Shibboleth.sso/SLO/Artifact"
                                 Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact"/>


            <!-- This tells IdPs that you only need transient identifiers. -->
            <NameIDFormat>urn:oasis:names:tc:SAML:2.0:nameid-format:transient</NameIDFormat>
            <NameIDFormat>urn:mace:shibboleth:1.0:nameIdentifier</NameIDFormat>

            <!--
		This tells IdPs where and how to send authentication assertions. Mostly
		the SP will tell the IdP what location to use in its request, but this
		is how the IdP validates the location and also figures out which
		SAML version/binding to use.
		-->

            <AssertionConsumerService index="1" isDefault="true"
                                      Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST"
                                      Location="https://sp.testshib.org/Shibboleth.sso/SAML2/POST"/>
            <AssertionConsumerService index="2"
                                      Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST-SimpleSign"
                                      Location="https://sp.testshib.org/Shibboleth.sso/SAML2/POST-SimpleSign"/>
            <AssertionConsumerService index="3"
                                      Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Artifact"
                                      Location="https://sp.testshib.org/Shibboleth.sso/SAML2/Artifact"/>
            <AssertionConsumerService index="4"
                                      Binding="urn:oasis:names:tc:SAML:1.0:profiles:browser-post"
                                      Location="https://sp.testshib.org/Shibboleth.sso/SAML/POST"/>
            <AssertionConsumerService index="5"
                                      Binding="urn:oasis:names:tc:SAML:1.0:profiles:artifact-01"
                                      Location="https://sp.testshib.org/Shibboleth.sso/SAML/Artifact"/>
            <AssertionConsumerService index="6"
                                      Binding="http://schemas.xmlsoap.org/ws/2003/07/secext"
                                      Location="https://sp.testshib.org/Shibboleth.sso/ADFS"/>

            <!-- A couple additional assertion consumers for the registration webapp. -->

            <AssertionConsumerService index="7"
                                      Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST"
                                      Location="https://www.testshib.org/Shibboleth.sso/SAML2/POST"/>
            <AssertionConsumerService index="8"
                                      Binding="urn:oasis:names:tc:SAML:1.0:profiles:browser-post"
                                      Location="https://www.testshib.org/Shibboleth.sso/SAML/POST"/>

        </SPSSODescriptor>

        <!-- This is just information about the entity in human terms. -->
        <Organization>
            <OrganizationName xml:lang="en">TestShib Two Service Provider</OrganizationName>
            <OrganizationDisplayName xml:lang="en">TestShib Two</OrganizationDisplayName>
            <OrganizationURL xml:lang="en">http://www.testshib.org/testshib-two/</OrganizationURL>
        </Organization>
        <ContactPerson contactType="technical">
            <GivenName>Nate</GivenName>
            <SurName>Klingenstein</SurName>
            <EmailAddress>ndk@internet2.edu</EmailAddress>
        </ContactPerson>

    </EntityDescriptor>


</EntitiesDescriptor>
#+END_SRC
* truststore.jks
  The public key for the server is stored here 
  #+BEGIN_SRC :eval no :tangle truststore.jks
  feed feed 0000 0002 0000 0002 0000 0002
000c 6573 7365 6e74 6961 6c73 736c 0000
0148 7ded b9a5 0005 582e 3530 3900 0005
0730 8205 0330 8203 eba0 0302 0102 0210
18b2 cbba a304 f1a0 0fc1 f2f3 2646 2a4a
300d 0609 2a86 4886 f70d 0101 0505 0030
8181 310b 3009 0603 5504 0613 0247 4231
1b30 1906 0355 0408 1312 4772 6561 7465
7220 4d61 6e63 6865 7374 6572 3110 300e
0603 5504 0713 0753 616c 666f 7264 311a
3018 0603 5504 0a13 1143 4f4d 4f44 4f20
4341 204c 696d 6974 6564 3127 3025 0603
5504 0313 1e43 4f4d 4f44 4f20 4365 7274
6966 6963 6174 696f 6e20 4175 7468 6f72
6974 7930 1e17 0d30 3631 3230 3130 3030
3030 305a 170d 3139 3132 3331 3233 3539
3539 5a30 7231 0b30 0906 0355 0406 1302
4742 311b 3019 0603 5504 0813 1247 7265
6174 6572 204d 616e 6368 6573 7465 7231
1030 0e06 0355 0407 1307 5361 6c66 6f72
6431 1a30 1806 0355 040a 1311 434f 4d4f
444f 2043 4120 4c69 6d69 7465 6431 1830
1606 0355 0403 130f 4573 7365 6e74 6961
6c53 534c 2043 4130 8201 2230 0d06 092a
8648 86f7 0d01 0101 0500 0382 010f 0030
8201 0a02 8201 0100 adf0 08b0 72c6 ab83
1231 1770 8985 a920 12d4 986a ed80 d4d1
dfe4 8e59 2dd3 9621 8d76 d23f 180b 4619
630b c720 f3e5 0bdd 801a f15a a0bd 1d76
cdb7 233a 745e 611b 75aa 9bd4 85f4 e178
91d3 2de1 affc 982e 06d2 793d 5ac0 1f21
2d1c ae21 53c6 3aa7 217e beed 676f 751d
1a9f 6a5b 06b3 6ae3 b10b aa6a 0ee7 6d6c
c3ca 958c 37ce 211f 3590 7ddb da1a 5ca8
8814 b20f c812 205f c5d3 7fe8 e138 e0db
bcf9 1fa1 aad6 1b90 0721 fa45 2450 5d27
2aa0 2841 455b 7dbc a0a2 2faa 9b7e 5b53
c5f1 0516 577e 11d7 3bb4 d901 76dc df7d
10cf 51a9 e538 f27b 1400 7559 f9f0 59db
173e f7af e602 2da4 79c1 5da2 1cc3 9ac8
a7a8 0b48 0a6a 2e7f 2d97 65f6 c504 9c44
c899 967e 7ea4 dd2f 0203 0100 01a3 8201
8330 8201 7f30 1f06 0355 1d23 0418 3016
8014 0b58 e58b c64c 1537 a440 a930 a921
be47 365a 56ff 301d 0603 551d 0e04 1604
14da cbea ad5b 085d ccff fc26 54ce 49e5
55c6 38f4 f830 0e06 0355 1d0f 0101 ff04
0403 0201 0630 1206 0355 1d13 0101 ff04
0830 0601 01ff 0201 0030 2006 0355 1d25
0419 3017 060a 2b06 0104 0182 370a 0303
0609 6086 4801 86f8 4204 0130 3e06 0355
1d20 0437 3035 3033 0604 551d 2000 302b
3029 0608 2b06 0105 0507 0201 161d 6874
7470 733a 2f2f 7365 6375 7265 2e63 6f6d
6f64 6f2e 636f 6d2f 4350 5330 4906 0355
1d1f 0442 3040 303e a03c a03a 8638 6874
7470 3a2f 2f63 726c 2e63 6f6d 6f64 6f63
612e 636f 6d2f 434f 4d4f 444f 4365 7274
6966 6963 6174 696f 6e41 7574 686f 7269
7479 2e63 726c 306c 0608 2b06 0105 0507
0101 0460 305e 3036 0608 2b06 0105 0507
3002 862a 6874 7470 3a2f 2f63 7274 2e63
6f6d 6f64 6f63 612e 636f 6d2f 436f 6d6f
646f 5554 4e53 4743 4341 2e63 7274 3024
0608 2b06 0105 0507 3001 8618 6874 7470
3a2f 2f6f 6373 702e 636f 6d6f 646f 6361
2e63 6f6d 300d 0609 2a86 4886 f70d 0101
0505 0003 8201 0100 2d97 347a 4032 ea70
972f 813b 4b79 1277 aefb aad7 1aa8 da5f
f3a1 db9e 4d96 cb37 7aa8 eaee 9b95 db9d
bbe1 279e fd45 ed0e 5296 acf4 27bf 74aa
92f4 a5c4 4300 1f0e b578 f98a c58c 70bd
9a7a 31a3 29d0 596b 4c33 b52c f88b 0f92
6357 56ac 2467 8a5b 2f29 c2b1 b9da 24c5
e462 0e7e 79c3 feb9 83ea 273b bc1d 43b5
6e17 aafb c898 886a d9f2 7ca1 f671 ba19
4fb8 38e3 42d7 f0da b1c0 23df ddd7 f1a7
ed09 8f56 a0ab c30b cba4 9280 8192 1fa9
6ff9 6c33 dc3e 57c6 a7f2 1fcc 2a7c e42c
4c46 5feb f361 f72b c435 9f8d 58f5 3a83
440e d893 ac4c 6bcc 77f4 03cd ccdc e01c
4b5d 25da 3d5e ce77 8ae1 3ec6 d794 cd70
493c ff0e bd08 48ab e552 1415 9d0e 9c1a
8756 68ad 9c09 0064 0000 0002 0006 6361
6365 7274 0000 0147 3e6a e448 0005 582e
3530 3900 0006 8e30 8206 8a30 8204 72a0
0302 0102 0203 0ef0 ac30 0d06 092a 8648
86f7 0d01 010d 0500 3079 3110 300e 0603
5504 0a13 0752 6f6f 7420 4341 311e 301c
0603 5504 0b13 1568 7474 703a 2f2f 7777
772e 6361 6365 7274 2e6f 7267 3122 3020
0603 5504 0313 1943 4120 4365 7274 2053
6967 6e69 6e67 2041 7574 686f 7269 7479
3121 301f 0609 2a86 4886 f70d 0109 0116
1273 7570 706f 7274 4063 6163 6572 742e
6f72 6730 1e17 0d31 3430 3432 3832 3035
3735 355a 170d 3136 3034 3237 3230 3537
3535 5a30 5b31 0b30 0906 0355 0406 1302
4155 310c 300a 0603 5504 0813 034e 5357
310f 300d 0603 5504 0713 0653 7964 6e65
7931 1430 1206 0355 040a 130b 4341 6365
7274 2049 6e63 2e31 1730 1506 0355 0403
130e 7777 772e 6361 6365 7274 2e6f 7267
3082 0122 300d 0609 2a86 4886 f70d 0101
0105 0003 8201 0f00 3082 010a 0282 0101
00c4 83f3 42d0 0bee f93f e21f 63c5 a384
e3fd c5c2 a768 1662 da88 5845 a5dd 4116
c0e7 9e3b 2e13 36ee b483 12ca a8a6 a68d
6cd6 e86e 67f7 f390 bd69 9893 ee14 2b6f
2aa4 b2f6 6a8f e74c 9ff5 f58b 9718 fc3c
91a4 6d69 d2b3 8be8 6ae1 0fdb b190 b219
1621 a6ec db25 bf23 c56b 2686 2048 7bc9
7838 d3dd e4eb d5a9 a50b 3253 66af bd8b
acf1 fbfc f4f6 67b9 a2d3 fe61 6deb f3f2
7d55 92d1 74ea ab82 4e78 5271 8ee0 4614
a51d cc89 5252 355a 0bb1 168d 5006 3c07
c7a1 d579 9151 8c05 dd25 c506 4982 11e2
61fa f1af 5b34 e8cb 4dcf 2dba e735 c0de
f327 e4ef a5d4 203d 9e37 cd48 092c 2923
9bbd d7aa 2718 736c b8b7 5498 72f4 160c
9a95 2690 4e6e 9c9b 5475 ca2b 7912 05c1
cb02 0301 0001 a382 0237 3082 0233 300c
0603 551d 1301 01ff 0402 3000 300e 0603
551d 0f01 01ff 0404 0302 03a8 3034 0603
551d 2504 2d30 2b06 082b 0601 0505 0703
0206 082b 0601 0505 0703 0106 0960 8648
0186 f842 0401 060a 2b06 0104 0182 370a
0303 3033 0608 2b06 0105 0507 0101 0427
3025 3023 0608 2b06 0105 0507 3001 8617
6874 7470 3a2f 2f6f 6373 702e 6361 6365
7274 2e6f 7267 2f30 3106 0355 1d1f 042a
3028 3026 a024 a022 8620 6874 7470 3a2f
2f63 726c 2e63 6163 6572 742e 6f72 672f
7265 766f 6b65 2e63 726c 3082 0173 0603
551d 1104 8201 6a30 8201 6682 0e77 7777
2e63 6163 6572 742e 6f72 67a0 1c06 082b
0601 0505 0708 05a0 100c 0e77 7777 2e63
6163 6572 742e 6f72 6782 1173 6563 7572
652e 6361 6365 7274 2e6f 7267 a01f 0608
2b06 0105 0507 0805 a013 0c11 7365 6375
7265 2e63 6163 6572 742e 6f72 6782 1277
7777 6d61 696c 2e63 6163 6572 742e 6f72
67a0 2006 082b 0601 0505 0708 05a0 140c
1277 7777 6d61 696c 2e63 6163 6572 742e
6f72 6782 0a63 6163 6572 742e 6f72 67a0
1806 082b 0601 0505 0708 05a0 0c0c 0a63
6163 6572 742e 6f72 6782 0e77 7777 2e63
6163 6572 742e 6e65 74a0 1c06 082b 0601
0505 0708 05a0 100c 0e77 7777 2e63 6163
6572 742e 6e65 7482 0a63 6163 6572 742e
6e65 74a0 1806 082b 0601 0505 0708 05a0
0c0c 0a63 6163 6572 742e 6e65 7482 0e77
7777 2e63 6163 6572 742e 636f 6da0 1c06
082b 0601 0505 0708 05a0 100c 0e77 7777
2e63 6163 6572 742e 636f 6d82 0a63 6163
6572 742e 636f 6da0 1806 082b 0601 0505
0708 05a0 0c0c 0a63 6163 6572 742e 636f
6d30 0d06 092a 8648 86f7 0d01 010d 0500
0382 0201 0023 e529 2d01 2911 c040 3991
1c98 8dbb 176f 8356 ab01 b332 e414 8f12
79e7 c057 cd75 e9e9 3e33 fa65 46e8 23a4
dc4b e9cf 2f4a 9c8a aecd 1618 e967 fcd5
4cd3 594c 4830 faa2 8a16 c88b 9420 92c4
c979 0741 98d9 a06e 04bb 2a68 aaa5 3298
6ee5 05cf bc15 0075 6628 09ed 040f 2ad6
98d6 75b8 70c8 006a c3a7 d714 e584 ffbe
9cd2 b8cc 6d4b 31d4 df8a c12d 6fc8 a567
43c9 b8dd 774e be3c 804e 491e 79d9 c0b4
7f08 3f11 a154 f049 b8fb 9144 9728 d544
adac a5b8 0a1d 4f2a 9ac1 4b39 c755 c4e7
79d4 7492 2a41 db6f 8209 5109 314d b4ce
41f0 3a98 c9f5 9255 8f27 fc0b 0a3d 5833
1697 a3ac 12c6 4c79 9138 46bf 1421 a77a
91af 904b bde0 a474 66c1 423b d548 bdea
9edd e3c1 d656 3aab 0954 93db 1260 adca
33e0 deca 126e 1e75 f503 55e4 a843 6e50
a670 3fcf eb27 352c a565 7f75 d837 042b
71e6 b820 d726 3d53 9c93 d364 4fbe c82d
30a6 e237 81fb 4103 efb5 9d58 7bf5 f7ce
1d29 4253 ba39 f845 3e91 e038 f59f bd3e
7dfe 029e 92fa 2bc8 05b6 c02a d832 c99b
3d21 0b15 3861 b896 b486 8f0d 9a8d 675c
a9d9 e0a7 ecc9 93a4 88d4 1a38 8309 0fdc
8f54 8fa2 ebb3 5950 56e5 8cab d58f 2854
cd75 5281 6235 1227 7303 bc4e 3044 49dc
a007 89e6 5eb1 5661 a76a b71d ca3e fedc
4b45 e3bc c5ae 3a85 3362 2177 b892 422f
553f 8354 731e f115 8690 f2a3 5587 8307
6d39 38e8 2486 b8ad 673b ffbf 7aba b5b4
e9e8 345e 9b8e 7928 f2db 0f60 e7ee 0abf
41b5 3cfe 4fda 9e05 fd61 2806 8700 ab15
f031 1cbc b7ad 30e8 60
  #+END_SRC

* samlKeystore.jks
  For using SAML protocol we must have the SAML keys to interact and
  authenticate our CAS Server with Facebook, Twitter, etc.
#+BEGIN_SRC :eval no :tangle samlKeystore.jks
feed feed 0000 0002 0000 0001 0000 0001
000a 7061 6334 6a2d 6465 6d6f 0000 0144
e034 621c 0000 0502 3082 04fe 300e 060a
2b06 0104 012a 0211 0101 0500 0482 04ea
1108 5091 af69 b8f3 93a9 e6cd e2c2 8c5a
2cdc c455 74ec 010c d630 cadd dea1 0cf4
3024 5449 f1dd c5c9 d413 4a50 f60b d60f
55c1 2246 5807 96ac a746 ff21 ffa0 0304
3ac1 3bf5 92a4 7a2a fe9b c34b 3aaf a022
9a08 c95e 3ee7 e0ca 5ac1 9341 d4d7 5c5d
48f6 4aba cd72 cdf4 16cf 83a9 9dbd 67df
eb2a 1dd9 f9eb 0c90 6417 9174 be69 2ef9
3d56 cc6d 47a3 08f8 0354 953e 7b28 694e
3327 5245 d32c d8ef abf4 de16 0c04 18e8
5688 549d e714 3375 4abf aeb7 5411 6f34
fc2b 7389 e232 8ee2 dd19 3961 ecb6 8a1e
bfc4 4f90 2612 d1ea 7d6a 3d9f e17a 46bf
1aee fed8 fc45 a7cc 577b 4e1b 4c9b cde6
c4ba ed76 b68f cd93 0353 80d9 818c 9129
e3b4 335f 06bb 5bcf 35fb 960f 0a08 2a7a
aadd a615 e185 b8f9 7c57 e25c e38c 4b46
ee79 53c8 3b9d c216 4faa 9241 9131 1b5f
082a 9365 21c8 d7ee 73c6 c52c 3afd 68e4
ae45 ee6b bdc6 141a 9580 f28c 4876 14e8
612c 8db6 bbaa ab14 8d37 ab8c d87a 04b4
02f2 6f71 6578 43bd cfb6 0740 bace 94be
0b25 2152 4e03 4b7c b06b 0943 770e 75b0
2a4c 6617 58d6 3bd5 4735 261b 561c 4f05
b27c 629e d96f 0246 593e c760 a57e 92a5
b707 9b47 8ebe 05b6 82f7 27d1 8c3e a471
52a6 5238 7624 4b00 d81a ce89 8309 37b6
4588 e5e9 0f9a 04f6 1e08 a336 6647 f0ff
e2a2 d0e1 d851 4f44 987b 0798 22fe 860b
fc72 1cc2 e7fc 653c 0a8b 99b2 66d5 60a7
f2b5 b395 2303 4a80 40b0 da52 5bc0 1637
f6c1 07a3 4ca5 2e8f e568 8c3c 6198 f49d
569b f71a 57f4 973e 3587 0056 2baa 4c25
319a 954c afc1 737d 2697 e91c 2dac 19a9
dda1 1d74 0739 65bc 719b 40f1 1eca 370b
5153 b9fe 338e 338c 41bb 8643 c88d 0de4
bdf3 d10c 7b3f 1a5b e4d3 4196 793a 4079
b8b5 9e45 db55 c520 ddc9 9ca9 0bfe f23f
8d10 006b 37fe d6ec b357 e1d3 d26b 0d3b
d235 b573 0ec0 b6ce db4c c31e f82a 357d
e51c eed4 c281 58de 646e 3344 91cc fcf8
ce55 4729 10d6 d7e9 691e c504 a5fa 2e82
5c91 bd12 fe7d ab9a 7dee a856 d672 b56e
42e1 2234 6dd4 12b0 837a 26fd 3c9f 9473
a5f9 eac4 6c9b 099b ef03 ae0b c213 f61f
f4ba 27d2 cd99 1448 fa55 636c 4dd9 bade
6230 52bc c2d9 b6d2 83d7 03c1 a551 cd6d
079b 1e02 0d9e 3c36 2573 a2c6 625f ecf5
8055 9c13 cc7f b372 a885 02a7 89cf 1baf
9822 32b9 fdbb 0ee9 36fe 05be 5093 04c6
ca5a a435 42b4 f7f0 4ff3 0219 899d 122f
4b47 2d43 ee57 60be dbc6 37a6 a0fb d2d3
d076 cd40 7920 edd9 28da 0f33 e7cd 4ca4
5998 f639 afea 92c9 affc 640f 913e 518b
66d7 8a17 782b b123 0468 65bf 6255 1d55
6afa 57ce 4af2 3a22 57a0 7bcb c2fe ee3f
6e29 29c4 0163 0ef9 f70a fa45 e5d2 500d
d494 1bbf 6254 53d5 6ccf 8a11 888f e0ee
5095 f360 48a2 d021 779d 371d 65ce d74c
9875 dc01 85db 07b7 03e9 15c2 f04d 2a03
1ef8 df2e bd93 6507 29ab 713e 08df 9dab
6f88 1a28 d126 086c ac75 b8c9 9701 ef7c
01e8 4c7c c5bd e192 803e 415d 06bc 0250
d3db 3cfb 3623 f67e 9536 8f92 be68 44dd
2faf 7cfb a5bf a5e1 7abd 6887 8f3b 6414
2d0b d530 dea8 0bb9 4262 9761 4de3 85f2
cf20 d5d5 903a 048a 6420 a6c4 c086 549f
f1e8 f88b c05e d82f d90b c0b8 0115 096c
27d1 474a 2016 2103 7683 08fe 9702 1a27
4248 4e1f a902 bbb5 16b0 1d90 2953 3e45
16eb 7e2d 61ac c278 86bb aac0 e9e2 68b0
2fac 727d 26d1 2120 a065 65a8 8fd3 1bac
be05 a622 d923 7fc4 c908 9ac7 8101 3cd7
9d33 991c 65be f111 ec53 ff99 9f51 0bcb
87ef 9aa2 eaa9 e5fc 3a67 61d5 52f9 97fb
bd4a f2e8 d089 196c bff1 54eb 7d0c 2be4
5829 1d5c d649 fe0b 664f ab49 1e8f 65b3
93ad de93 564e 09a3 426e f299 167d ace5
8cec 85d3 9f2a e00c 942d 0000 0001 0005
582e 3530 3900 0003 5e30 8203 5a30 8202
42a0 0302 0102 0204 532b 0f74 300d 0609
2a86 4886 f70d 0101 0505 0030 6f31 1030
0e06 0355 0406 1307 556e 6b6e 6f77 6e31
1030 0e06 0355 0408 1307 556e 6b6e 6f77
6e31 1030 0e06 0355 0407 1307 556e 6b6e
6f77 6e31 1030 0e06 0355 040a 1307 556e
6b6e 6f77 6e31 1030 0e06 0355 040b 1307
556e 6b6e 6f77 6e31 1330 1106 0355 0403
130a 7061 6334 6a2d 6465 6d6f 301e 170d
3134 3033 3230 3135 3535 3332 5a17 0d32
3430 3331 3731 3535 3533 325a 306f 3110
300e 0603 5504 0613 0755 6e6b 6e6f 776e
3110 300e 0603 5504 0813 0755 6e6b 6e6f
776e 3110 300e 0603 5504 0713 0755 6e6b
6e6f 776e 3110 300e 0603 5504 0a13 0755
6e6b 6e6f 776e 3110 300e 0603 5504 0b13
0755 6e6b 6e6f 776e 3113 3011 0603 5504
0313 0a70 6163 346a 2d64 656d 6f30 8201
2230 0d06 092a 8648 86f7 0d01 0101 0500
0382 010f 0030 8201 0a02 8201 0100 9be4
deb8 3647 6b80 91f6 765a 088f d928 f8c4
69b9 e497 4618 34df 9ade ae17 653f 5dc0
fe88 0554 512c 319c 27f9 29f3 3a42 0ceb
0626 bf0e 438b cc6c 8e63 8e62 c65d f3c6
d88b 5c32 84a7 3294 120b 508f 74f3 4787
1077 b8a2 fe26 0b57 7505 9041 cfef 92ea
5f3c a6d8 9915 aa3d 647c 9cf9 e180 547f
a2e4 6a1d 15dd 1ee1 63d4 2e68 1b9c 0b6c
aa5d 2352 42da 2a70 edb0 531b c219 51f3
faa7 ae13 2bb5 a2f3 f47c aecd c50d 0a2f
d06f e617 0d6b 2204 b2f2 9c2f a900 46c1
a9b7 ee20 6d5e a91e 55a9 702e 75c7 ac52
b3f1 17b8 f172 80ed 9854 a8d9 2a4c 1a9f
0842 ff54 5637 3598 4ea0 31ee a257 f997
0f48 4953 670e 3b88 a83a a026 b49f 20a0
5ad5 f534 2132 dd46 ce97 f8bb a25d 0203
0100 0130 0d06 092a 8648 86f7 0d01 0105
0500 0382 0101 0092 d2be 2f53 d12c 044e
7eca 984a e38e cacc d897 7ba3 de9c 11d6
5e94 8a03 f66a 4833 3988 ec2e a2a8 cdba
76f1 ea1e 33af ae35 13a9 faa4 b238 7b8d
2914 81a4 33d7 0607 749a cb73 fd02 9789
b735 a0ab ae0d 4862 e070 fac3 55d7 755b
b6cf 0eaf 7072 d108 6fdc 852f 6d5c cbcb
6656 f9eb 8530 bba9 63b5 2bf1 f08d 2223
a6af d754 512a 22c2 45cf 01da c274 7913
271c 58de bc02 56a6 3674 97cf 8dbf 4013
e569 0a68 93d5 52b9 873a 7e67 6f66 b190
8030 dbd3 92ef bbe4 44f7 c1de 0088 11ab
791e 294c d8d5 4ac1 f924 4fb9 73ac af17
5732 8647 9b22 bf10 c34e 7d08 c50d ccc8
763a b75c 8e79 e17b da14 b050 adae 5775
a316 5d76 83d4 ae22 367b 3b21 06b2 3883
0ad5 1f64 bebb a270 991c cb9f 1fd5 1984
f85c ab97 b93a dc38 cea7 fb
#+END_SRC
